<!DOCTYPE html>
<html class="scroll-smooth" lang="en">
<head>
    <title><%= user['firstname'] %>'s Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
    <link rel='stylesheet' href='/styles/style.css'/>
    <link rel="icon" type="png" href="/images/icon.png">
    <script src="/js/jquery-2.2.0.min.js" type="text/javascript"></script>
</head>
<body>
<script>
    $(document).ready(function () {
        const sessionToken = document.cookie.includes('session_token');
        if (!sessionToken) {
            location.href = '/';
        }
    });
</script>
<div class="container bg-[url('/images/background.jpg')] min-h-screen bg-center bg-cover min-w-full px-28 py-5 relative">

    <nav id="navbar"
         class="flex items-center bg-white bg-opacity-25 rounded-2xl px-2 h-fit shadow-2xl duration-300">
        <p class="ml-3 text-2xl shadow-2xl">Welcome <%= user['firstname'] %></p>
        <img class="ml-3 cursor-pointer" onclick="notifications.showModal()" src="/images/Bell-Empty.svg"
             alt="notifications">


        <!--todo add functionality-->
        <dialog class="backdrop-blur-sm" id="notifications">
            <p>Greetings, one and all!</p>
            <form method="dialog">
                <button>OK</button>
            </form>
        </dialog>

        <ul class="flex-1 text-center">

            <li class="list-none inline-block px-5">
                <a href="#Home" class="no-underline text-3xl text-black px-7 duration-300 hover:text-4xl">Home</a>
            </li>
            <li class="list-none inline-block px-5">
                <a href="#Tickets/Rides"
                   class="no-underline text-3xl text-black px-7 duration-300 hover:text-4xl">Tickets/Rides</a>
            </li>
            <li class="list-none inline-block px-5">
                <a href="#Account"
                   class="no-underline text-3xl text-black px-7 duration-300 hover:text-4xl">Account</a>
            </li>
        </ul>

        <a href="/"><img class="mr-7 w-7 h-7" src="/images/logout.png" alt="logout"></a>

        <a href="/">
            <img

                    class="w-40 hover:animate-pulse"
                    src="/images/icon.png"
                    alt="logo"/>
        </a>
        <script>
            $(function () {
                var scroll = $(document).scrollTop();
                var navHeight = $('#navbar').outerHeight();

                $(window).scroll(function () {
                    var scrolled = $(document).scrollTop();

                    if (scrolled > navHeight) {
                        $('#navbar').addClass('animate');
                    } else {

                        $('#navbar').removeClass('animate');
                    }

                    if (scrolled > scroll) {
                        $('#navbar').removeClass('sticky');
                    } else {
                        $('#navbar').addClass('sticky');
                    }

                    scroll = $(document).scrollTop();

                });
            });
        </script>
    </nav>

    <div class="bg-white rounded-xl container mt-24 w-full my-24 px-6 mx-auto shadow-2xl">
        <section id="Home" class="flex flex-col">
            <div class="mt-5 self-center text-2xl font-medium">
                <h1>
                    Quick Overview
                </h1>
            </div>
            <div class="self-center w-full my-8 max-w-md p-4 bg-white border border-gray-200 rounded-lg shadow sm:p-8">

                <div class="flex items-center justify-between mb-4">
                    <h5 class="text-xl font-bold leading-none text-gray-900 ">Upcoming Rides</h5>
                    <a href="#Tickets/Rides" class="text-sm font-medium text-blue-600 hover:underline">
                        View all
                    </a>
                </div>
                <div class="flow-root ">
                    <ul id="ridesList" role="list" class="divide-y divide-gray-200 max-h-64 overflow-y-scroll ">
                        <li class="py-3 sm:py-4">
                            <div class="flex items-center space-x-4">
                                <div class="flex-shrink-0">
                                    <img class="w-8 h-8 rounded-full" src="/images/MetroCarIcon.png"
                                         alt="Metro Car Icon">
                                </div>
                                <div class="flex-1 min-w-0">
                                    <p class="text-sm font-medium text-gray-900 truncate ">
                                        ride ID
                                    </p>
                                    <p class="text-sm text-gray-500 truncate ">
                                        origin -> dest
                                    </p>
                                </div>
                                <div class="inline-flex items-center text-base font-semibold text-gray-900 ">
                                    DateTime
                                </div>
                            </div>
                        </li>
                    </ul>
                    <script>
                        $(document).ready(function () {
                            // Retrieve the JSON data (can be fetched using AJAX, etc.)
                            const jsonData = <%-JSON.stringify(userRides) %>;
                            // console.log(jsonData)
                            // Parse the JSON data
                            const items = jsonData;

                            // Generate the HTML markup dynamically
                            let html = '';
                            items.forEach(function (item) {

                                if (item['status'] === 'upcoming') {
                                    html += ' <li class="py-3 sm:py-4">'
                                    html += '     <div class="flex items-center space-x-4">'
                                    html += '         <div class="flex-shrink-0">'
                                    html += '             <img class="w-8 h-8 rounded-full" src="/images/MetroCarIcon.png" alt="Neil image">'
                                    html += '             </div>'
                                    html += '         <div class="flex-1 min-w-0">'
                                    html += '             <p class="text-sm font-medium text-gray-900 truncate ">'
                                    html += "Ride ID: " + item['id']
                                    html += '             </p>'
                                    html += '             <p class="text-sm text-gray-500 truncate ">'
                                    html += item['origin'] + ' -> ' + item['destination']
                                    html += '             </p>'
                                    html += '         </div>'
                                    html += '         <div class="inline-flex items-center text-base font-semibold text-gray-900 ">'
                                    html += item['tripdate']
                                    html += '         </div>'
                                    html += '         </div>'
                                    html += ' </li>'
                                }
                            });

                            // Insert the generated HTML into the element with the specified ID
                            $('#ridesList').html(html);
                        });
                    </script>
                </div>
            </div>

            <div class="self-center w-full my-8 max-w-md p-4 bg-white border border-gray-200 rounded-lg shadow sm:p-8">

                <div class="flex items-center justify-between mb-4">
                    <h5 class="text-xl font-bold leading-none text-gray-900 ">My Transactions History</h5>
                    <a href="#Tickets/Rides" class="text-sm font-medium text-blue-600 hover:underline">
                        View all
                    </a>
                </div>
                <div class="flow-root ">
                    <ul id="TransactionHistory" role="list"
                        class="divide-y divide-gray-200 max-h-64 overflow-y-scroll ">
                        <li class="py-3 sm:py-4">
                            <div class="flex items-center space-x-4">
                                <div class="flex-shrink-0">
                                    <img class="w-8 h-8 rounded-full" src="/images/transaction.png"
                                         alt="Metro Car Icon">
                                </div>
                                <div class="flex-1 min-w-0">
                                    <p class="text-sm font-medium text-gray-900 truncate ">
                                        Transaction ID + purchaseID
                                    </p>
                                    <p class="text-sm text-gray-500 truncate ">
                                        purchase type
                                    </p>
                                </div>
                                <div class="inline-flex items-center text-base font-semibold text-gray-900 ">
                                    amount
                                </div>
                            </div>
                        </li>
                    </ul>

                    <script>
                        $(document).ready(function () {
                            // Retrieve the JSON data (can be fetched using AJAX, etc.)
                            const jsonData = <%-JSON.stringify(purchaseHistory) %>;
                            // console.log(jsonData)
                            // Parse the JSON data
                            const items = jsonData;

                            // Generate the HTML markup dynamically
                            let html = '';
                            items.forEach(function (item) {


                                html += ' <li class="py-3 sm:py-4">'
                                html += '     <div class="flex items-center space-x-4">'
                                html += '         <div class="flex-shrink-0">'
                                html += '             <img class="w-8 h-8 rounded-full" src="/images/train-station.png" alt="Neil image">'
                                html += '             </div>'
                                html += '         <div class="flex-1 min-w-0">'
                                html += '             <p class="text-sm font-medium text-gray-900 truncate ">'
                                html += "Transaction ID: " + item['id'] + '-' + item['purchasediid']
                                html += '             </p>'
                                html += '             <p class="text-sm text-gray-500 truncate ">'
                                html += "Payment Method: " + item['purchasetype']
                                html += '             </p>'
                                html += '         </div>'
                                html += '         <div class="inline-flex items-center text-base font-semibold text-gray-900 ">'
                                html += item['amount'] + "EGP"
                                html += '         </div>'
                                html += '         </div>'
                                html += ' </li>'
                            });

                            // Insert the generated HTML into the element with the specified ID
                            $('#TransactionHistory').html(html);
                        });
                    </script>

                </div>
            </div>

            <div class="self-center w-full my-8 max-w-md p-4 bg-white border border-gray-200 rounded-lg shadow sm:p-8">

                <div class="flex items-center justify-between mb-4">
                    <h5 class="text-xl font-bold leading-none text-gray-900 ">Available Stations</h5>
                    <a href="#Tickets/Rides" class="text-sm font-medium text-blue-600 hover:underline">
                        View all
                    </a>
                </div>
                <div class="flow-root ">
                    <ul id="StationList" role="list" class="divide-y divide-gray-200 max-h-64 overflow-y-scroll ">
                        <li class="py-3 sm:py-4">
                            <div class="flex items-center space-x-4">
                                <div class="flex-shrink-0">
                                    <img class="w-8 h-8 rounded-full" src="/images/train-station.png"
                                         alt="Metro Car Icon">
                                </div>
                                <div class="flex-1 min-w-0">
                                    <p class="text-sm font-medium text-gray-900 truncate ">
                                        Station Name
                                    </p>
                                    <p class="text-sm text-gray-500 truncate ">
                                        Position and type
                                    </p>
                                </div>
                                <div class="inline-flex items-center text-base font-semibold text-gray-900 ">
                                    status
                                </div>
                            </div>
                        </li>
                    </ul>

                    <script>
                        $(document).ready(function () {
                            // Retrieve the JSON data (can be fetched using AJAX, etc.)
                            const jsonData = <%-JSON.stringify(stations) %>;
                            // console.log(jsonData)
                            // Parse the JSON data
                            const items = jsonData;

                            // Generate the HTML markup dynamically
                            let html = '';
                            items.forEach(function (item) {


                                html += ' <li class="py-3 sm:py-4">'
                                html += '     <div class="flex items-center space-x-4">'
                                html += '         <div class="flex-shrink-0">'
                                html += '             <img class="w-8 h-8 rounded-full" src="/images/train-station.png" alt="Neil image">'
                                html += '             </div>'
                                html += '         <div class="flex-1 min-w-0">'
                                html += '             <p class="text-sm font-medium text-gray-900 truncate ">'
                                html += "Station Name: " + item['stationname']
                                html += '             </p>'
                                html += '             <p class="text-sm text-gray-500 truncate ">'
                                html += item['stationtype'] + ' --- ' + item['stationposition']
                                html += '             </p>'
                                html += '         </div>'
                                html += '         <div class="inline-flex items-center text-base font-semibold text-gray-900 ">'
                                html += item['stationstatus']
                                html += '         </div>'
                                html += '         </div>'
                                html += ' </li>'
                            });

                            // Insert the generated HTML into the element with the specified ID
                            $('#StationList').html(html);
                        });
                    </script>

                </div>
            </div>


        </section>
    </div>


    <div class="bg-white rounded-xl container mt-28 w-full my-24 px-6 mx-auto shadow-2xl">
        <section id="Tickets/Rides" class="flex flex-col">
            <div class="mt-5 self-center text-2xl font-medium">
                <h1>
                    Tickets & Rides
                </h1>
            </div>
            <!--todo add buy ticket button w fo2eeh haykoon feeh el tickets bt3t abl kda... ride hykoon feeha these rides w past ones-->
            <div class="self-center w-full my-8 max-w-md p-4 bg-white border border-gray-200 rounded-lg shadow sm:p-8">

                <div class="flex items-center justify-between mb-4">
                    <h5 class="text-xl font-bold leading-none text-gray-900 ">Rides</h5>
                </div>
                <div class="flow-root ">
                    <ul role="list" class="divide-y divide-gray-200 max-h-64 overflow-y-scroll ">
                        <li class="py-3 sm:py-4">
                            <div class="flex items-center space-x-4">
                                <div class="flex-shrink-0">
                                    <img class="w-8 h-8 rounded-full" src="/images/MetroCarIcon.png"
                                         alt="Metro Car Icon">
                                </div>
                                <div class="flex-1 min-w-0">
                                    <p class="text-sm font-medium text-gray-900 truncate ">
                                        ride ID
                                    </p>
                                    <p class="text-sm text-gray-500 truncate ">
                                        origin -> dest
                                    </p>
                                </div>
                                <div class="inline-flex items-center text-base font-semibold text-gray-900 ">
                                    DateTime
                                </div>
                            </div>
                        </li>
                    </ul>
                    <script>

                    </script>
                </div>
            </div>

            <div class="self-center w-full my-8 max-w-md p-4 bg-white border border-gray-200 rounded-lg shadow sm:p-8">

                <div class="flex items-center justify-between mb-4">
                    <h5 class="text-xl font-bold leading-none text-gray-900 ">Zones</h5>
<!--todo                    redirect to subscriptions to show all zones -->
                </div>
                <div class="flow-root ">
                    <ul id="ZonesList" role="list" class="divide-y divide-gray-200 max-h-64 overflow-y-scroll ">
                        <li class="py-3 sm:py-4">
                            <div class="flex items-center space-x-4">
                                <div class="flex-shrink-0">
                                    <img class="w-8 h-8 rounded-full" src="/images/train-station.png"
                                         alt="Metro Car Icon">
                                </div>
                                <div class="flex-1 min-w-0">
                                    <p class="text-sm font-medium text-gray-900 truncate ">
                                        Zone ID
                                    </p>
                                    <p class="text-sm text-gray-500 truncate ">
                                        Zone type
                                    </p>
                                </div>
                                <div class="inline-flex items-center text-base font-semibold text-gray-900 ">
                                    Zone price
                                </div>
                            </div>
                        </li>
                    </ul>

                    <script>
                        //todo check how to return value from ajax
                        $(document).ready(function () {

                            let jsonData = []

                            $.get("api/v1/zones", function( data ) {
                                console.log( typeof data ); // string
                                console.log( data ); // HTML content of the jQuery.ajax page
                                jsonData = data

                                console.log("dasdwdad" ,jsonData)
                                // Parse the JSON data
                                const items = jsonData;

                                // Generate the HTML markup dynamically
                                let html = '';
                                items.forEach(function (item) {


                                    html += ' <li class="py-3 sm:py-4">'
                                    html += '     <div class="flex items-center space-x-4">'
                                    html += '         <div class="flex-shrink-0">'
                                    html += '             <img class="w-8 h-8 rounded-full" src="/images/train-station.png" alt="Neil image">'
                                    html += '             </div>'
                                    html += '         <div class="flex-1 min-w-0">'
                                    html += '             <p class="text-sm font-medium text-gray-900 truncate ">'
                                    html += "Zone ID: " + item['id']
                                    html += '             </p>'
                                    html += '             <p class="text-sm text-gray-500 truncate ">'
                                    html +=  "Zone type: " + item['zonetype']
                                    html += '             </p>'
                                    html += '         </div>'
                                    html += '         <div class="inline-flex items-center text-base font-semibold text-gray-900 ">'
                                    html +=  "Price: " + item['price'] + " EGP"
                                    html += '         </div>'
                                    html += '         </div>'
                                    html += ' </li>'
                                });

                                // Insert the generated HTML into the element with the specified ID
                                $('#ZonesList').html(html);
                            });
                        });
                    </script>

                </div>
            </div>

        </section>
    </div>


    <section id="Account" class="flex flex-col">
        <div
                class="self-center mt-6 w-2/3 rounded-2xl bg-white text-center shadow-[0_2px_15px_-3px_rgba(0,0,0,0.07),0_10px_20px_-2px_rgba(0,0,0,0.04)]">
            <div
                    class="text-3xl border-b-2 border-neutral-100 px-6 py-3">
                My Account
            </div>
            <div class="p-6">
                <h3
                        class="place-items-start flex flex-col mb-2 text-2xl font-medium leading-tight text-neutral-800">
                     <span class="mb-3 text-2xl">
                    User ID: <%= user['userid'] %>
                    </span>
                    <span class="mb-3 text-2xl">
                    First Name: <%= user['firstname'] %>
                    </span>
                    <span class="mb-3 text-2xl">
                    Last Name: <%= user['lastname'] %>
                    </span>
                    <span class="mb-3 text-2xl">
                    Email: <%= user['email'] %>
                    </span>
                    <span class="mb-3 text-2xl" id="upcomingRides">
                        <script>
                            const user = <%-JSON.stringify(user) %>;
                            $(document).ready(function () {
                                userType = function () {
                                    if (user.isNormal)
                                        return "User"
                                    else if (user.isSenior)
                                        return "Senior"
                                    else
                                        return "Admin"
                                }
                                $("#RoleToUserType").append("User Type: " + userType())
                            });
                        </script>
                    </span>
                </h3>


                <!--todo add functionality-->
                <button
                        type="button"
                        onclick="PayForSubscription.showModal()"
                        class="w-full h-20 my-6 rounded rounded-lg bg-orange-700 text-l font-medium uppercase leading-normal text-white shadow-[0_4px_9px_-4px_#3b71ca] transition duration-150 ease-in-out hover:bg-orange-800 hover:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.3),0_4px_18px_0_rgba(59,113,202,0.2)] focus:bg-orange-600 focus:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.3),0_4px_18px_0_rgba(59,113,202,0.2)] focus:outline-none focus:ring-0 active:bg-orange-900 active:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.3),0_4px_18px_0_rgba(59,113,202,0.2)](59,113,202,0.5)]-4px_rgba(59,113,202,0.2),0_4px_18px_0_rgba(59,113,202,0.1)]-4px_rgba(59,113,202,0.2),0_4px_18px_0_rgba(59,113,202,0.1)]-4px_rgba(59,113,202,0.2),0_4px_18px_0_rgba(59,113,202,0.1)]"
                        data-te-ripple-init
                >
                    Pay For Subscription
                </button>


                <!--todo add functionality-->
                <dialog class="rounded-2xl" id="PayForSubscription">

                    <div class="flex justify-center items-center scrollbar-hide">
                        <div class="w-80 bg-white p-3 rounded-lg">
                            <p class="text-xl font-semibold">Payment Details</p>
                            <div class="input_text mt-6 relative"><input id="CardHolderNameInput" type="text"
                                                                         class="h-12 pl-7 outline-none px-2 focus:border-blue-900 transition-all w-full border-b "
                                                                         placeholder="John Row"/> <span
                                    class="absolute left-0 text-sm -top-4">Cardholder Name</span> <i
                                    class="absolute left-2 top-4 text-gray-400 fa fa-user"></i></div>
                            <div class="input_text mt-8 relative"><input id="CardNumberInput" type="text"
                                                                         class="h-12 pl-7 outline-none px-2 focus:border-blue-900 transition-all w-full border-b "
                                                                         placeholder="0000 0000 0000 0000"
                                                                         data-slots="0" data-accept="\d" size="19"/>
                                <span class="absolute left-0 text-sm -top-4">Card Number</span> <i
                                        class="absolute left-2 top-[14px] text-gray-400 text-sm fa fa-credit-card"></i>
                            </div>
                            <div class="mt-8 flex gap-5 ">
                                <div class="input_text relative w-full"><input id="ExpiryInput" type="text"
                                                                               class="h-12 pl-7 outline-none px-2 focus:border-blue-900 transition-all w-full border-b "
                                                                               placeholder="mm/yyyy" data-slots="my"/>
                                    <span class="absolute left-0 text-sm -top-4">Expiry</span> <i
                                            class="absolute left-2 top-4 text-gray-400 fa fa-calendar-o"></i></div>
                                <div class="input_text relative w-full"><input id="CVVInput" type="text"
                                                                               class="h-12 pl-7 outline-none px-2 focus:border-blue-900 transition-all w-full border-b "
                                                                               placeholder="000" data-slots="0"
                                                                               data-accept="\d" size="3"/> <span
                                        class="absolute left-0 text-sm -top-4">CVV</span> <i
                                        class="absolute left-2 top-4 text-gray-400 fa fa-lock"></i></div>
                            </div>

                            <div class="mt-8 flex gap-5 ">
                                <div class="input_text relative w-full"><input id="ZoneIdInput" type="text"
                                                                               class="h-12 pl-7 outline-none px-2 focus:border-blue-900 transition-all w-full border-b "
                                                                               placeholder="0" data-slots="0"
                                                                               data-accept="\d" size="3"/> <span
                                        class="absolute left-0 text-sm -top-4">Zone ID</span> <i
                                        class="absolute left-2 top-4 text-gray-400 fa fa-lock"></i></div>
                            </div>


                            <div>
                                <label>Choose Subscription Type:
                                    <select id="SubscriptionTypeInput" class="block py-2.5 px-0 w-full text-sm text-black bg-transparent border-0 border-b-2 border-gray-200 appearance-none dark:text-gray-400 dark:border-gray-700 focus:outline-none focus:ring-0 focus:border-gray-200 peer">
                                        <option value="annual">Year (365 days)</option>
                                        <option value="month">Month (30 days)</option>
                                        <option value="quarterly">Quarterly (90 days)</option>
                                    </select>


                                    <script>
                                        //on change of SubscriptionTypeInput update the payment amount todo get zone prices
                                        $(document).ready(function () {

                                        })
                                    </script>


                                    <script>
                                        //todo check how to return value from ajax
                                        $(document).ready(function () {

                                            $("#SubscriptionTypeInput").change(function () {


                                                let jsonData = []

                                                $.get("api/v1/zones", function( data ) {
                                                    console.log( typeof data ); // string
                                                    console.log( data ); // HTML content of the jQuery.ajax page
                                                    jsonData = data

                                                    console.log("dasdwdad" ,jsonData)
                                                    // Parse the JSON data
                                                    const items = jsonData;

                                                    // Generate the HTML markup dynamically
                                                    let html = '';
                                                    items.forEach(function (item) {


                                                        html += ' <li class="py-3 sm:py-4">'
                                                        html += '     <div class="flex items-center space-x-4">'
                                                        html += '         <div class="flex-shrink-0">'
                                                        html += '             <img class="w-8 h-8 rounded-full" src="/images/train-station.png" alt="Neil image">'
                                                        html += '             </div>'
                                                        html += '         <div class="flex-1 min-w-0">'
                                                        html += '             <p class="text-sm font-medium text-gray-900 truncate ">'
                                                        html += "Zone ID: " + item['id']
                                                        html += '             </p>'
                                                        html += '             <p class="text-sm text-gray-500 truncate ">'
                                                        html +=  "Zone type: " + item['zonetype']
                                                        html += '             </p>'
                                                        html += '         </div>'
                                                        html += '         <div class="inline-flex items-center text-base font-semibold text-gray-900 ">'
                                                        html +=  "Price: " + item['price'] + " EGP"
                                                        html += '         </div>'
                                                        html += '         </div>'
                                                        html += ' </li>'
                                                    });
                                                    //todo get zones then on change get the zone price based on that id
                                                    // Insert the generated HTML into the element with the specified ID
                                                    $('#ZonesList').html(html);
                                                });

                                                if(){
                                                    $('#CardHolderNameInput').text();
                                                }
                                            })
                                        });
                                    </script>

                                </label>
                            </div>

                            <p id="PaymentAmountLabel" class="text-lg text-center mt-4 text-gray-600 font-semibold">Payment amount: </p>
                            <p id="ErrorLabel" style="visibility: hidden" class="text-lg text-center mt-4 text-red-700 font-semibold"></p>
                            <div class="flex flex-col justify-center mt-4">
                                <button id="PayForSubscriptionButton" class="self-center outline-none pay h-12 bg-orange-600 text-white mb-3 hover:bg-orange-700 rounded-lg w-1/2 cursor-pointer transition-all">
                                    Pay
                                </button>

                                <script>
                                    //todo kamel when ehab adds the rest
                                    $(document).ready(function () {
                                        $("#PayForSubscriptionButton").click(function () {
                                            const user = <%-JSON.stringify(user) %>;
                                            const cardHolderName = $('#CardHolderNameInput').val();
                                            const cardNumber = $('#CardNumberInput').val();
                                            const expiry = $('#ExpiryInput').val();
                                            const cVV = $('#CVVInput').val();
                                            const zoneId = $('#ZoneIdInput').val();
                                            const subscriptionType = $('#SubscriptionTypeInput').val();
                                            const paymentAmount = $('#PaymentAmountLabel');
                                            const errorLabel = $('#ErrorLabel');


                                            data = {
                                                creditCardNumber: cardNumber,
                                                holderName: cardHolderName,
                                                payedAmount: paymentAmount,
                                                subType: subscriptionType,
                                                zoneId: zoneId
                                            }

                                            //todo handle if any of the inputs is empty
                                            for(let i in data) {
                                                if (i !== "") {
                                                    errorLabel.css("visibility", "visible")
                                                    errorLabel.text(i, "is missing!")
                                                    $('#CurrentPassword').text("")
                                                    $('#NewPassword').text("");
                                                    return
                                                }
                                            }
                                            errorLabel.css("visibility", "hidden")

                                            $.ajax({
                                                type: "POST",
                                                url: '/api/v1/payment/subscription',
                                                data,
                                                success: function (serverResponse) {
                                                    if (serverResponse) {
                                                        console.log("success")
                                                    }
                                                },
                                                error: function (errorResponse) {
                                                    if (errorResponse) {
                                                        alert(`User Password reset error: ${errorResponse.responseText}`);
                                                        console.log("error")
                                                    }
                                                }
                                            });
                                        });
                                    });
                                </script>

                                <button type="button" id="ClosePayForSubscription"
                                        class="self-center focus:outline-none text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-900">
                                    Cancel
                                </button>
                                <script>
                                    const dialog = document.querySelector("#PayForSubscription");
                                    const closeButton = document.querySelector("#ClosePayForSubscription");
                                    closeButton.addEventListener("click", () => {
                                        dialog.close();
                                    });
                                </script>
                            </div>
                        </div>
                    </div>

                    <script>
                        document.addEventListener('DOMContentLoaded', () => {
                            for (const el of document.querySelectorAll("[placeholder][data-slots]")) {
                                const pattern = el.getAttribute("placeholder"),
                                    slots = new Set(el.dataset.slots || "_"),
                                    prev = (j => Array.from(pattern, (c, i) => slots.has(c) ? j = i + 1 : j))(0),
                                    first = [...pattern].findIndex(c => slots.has(c)),
                                    accept = new RegExp(el.dataset.accept || "\\d", "g"),
                                    clean = input => {
                                        input = input.match(accept) || [];
                                        return Array.from(pattern, c =>
                                            input[0] === c || slots.has(c) ? input.shift() || c : c
                                        );
                                    },
                                    format = () => {
                                        const [i, j] = [el.selectionStart, el.selectionEnd].map(i => {
                                            i = clean(el.value.slice(0, i)).findIndex(c => slots.has(c));
                                            return i < 0 ? prev[prev.length - 1] : back ? prev[i - 1] || first : i;
                                        });
                                        el.value = clean(el.value).join``;
                                        el.setSelectionRange(i, j);
                                        back = false;
                                    };
                                let back = false;
                                el.addEventListener("keydown", (e) => back = e.key === "Backspace");
                                el.addEventListener("input", format);
                                el.addEventListener("focus", format);
                                el.addEventListener("blur", () => el.value === pattern && (el.value = ""));
                            }
                        });

                        var pay = document.querySelector(".pay");
                        var allinputs = document.querySelectorAll(".input_text input")
                        pay.addEventListener('click', function () {
                            allinputs.forEach((e) => {
                                e.classList.remove('warning');
                                if (e.value.length < 1) {
                                    e.classList.add('warning');
                                }
                            });
                        });

                        allinputs.forEach((all) => {
                            all.addEventListener('keyup', function () {
                                if (all.value.length < 1) {
                                    all.classList.add('warning');

                                } else {
                                    all.classList.remove('warning');
                                }
                            });
                        });
                    </script>
                </dialog>


                <button
                        type="button"
                        onclick="PasswordModal.showModal()"
                        class="w-full h-20 my-6 rounded rounded-lg bg-amber-700 text-l font-medium uppercase leading-normal text-white shadow-[0_4px_9px_-4px_#3b71ca] transition duration-150 ease-in-out hover:bg-amber-800 hover:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.3),0_4px_18px_0_rgba(59,113,202,0.2)] focus:bg-amber-600 focus:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.3),0_4px_18px_0_rgba(59,113,202,0.2)] focus:outline-none focus:ring-0 active:bg-amber-900 active:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.3),0_4px_18px_0_rgba(59,113,202,0.2)](59,113,202,0.5)]-4px_rgba(59,113,202,0.2),0_4px_18px_0_rgba(59,113,202,0.1)]-4px_rgba(59,113,202,0.2),0_4px_18px_0_rgba(59,113,202,0.1)]-4px_rgba(59,113,202,0.2),0_4px_18px_0_rgba(59,113,202,0.1)]"
                        data-te-ripple-init
                >
                    Reset Password
                </button>

                <dialog class="" id="PasswordModal">
                    <div class="container flex flex-col">

                        <button
                                id="closePasswordModal"
                                type="reset"
                                class="rounded-3xl bg-blue-500 text-bold text-2xl justify-self-end self-end mx-2 my-2 px-2 py-1">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                 class="bi bi-x" viewBox="0 0 16 16">
                                <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
                            </svg>
                        </button>
                        <script>
                            $(document).ready(function () {
                                const dialog = document.querySelector("#PasswordModal");
                                const closeButton = document.querySelector("#closePasswordModal");
                                closeButton.addEventListener("click", () => {
                                    dialog.close();
                                });
                            });
                        </script>


                        <form class="flex flex-col container" method="dialog">
                            <div class="relative mb-3">
                                <input
                                        type="text"
                                        class="peer m-0 block h-[58px] w-full rounded border border-solid border-neutral-300 bg-transparent bg-clip-padding px-6 py-4 text-lg font-normal leading-tight text-neutral-700 transition duration-200 ease-linear placeholder:text-transparent focus:border-primary focus:pb-[0.625rem] focus:pt-[1.625rem] focus:text-neutral-700 focus:outline-none peer-focus:text-primary [&:not(:placeholder-shown)]:pb-[0.625rem] [&:not(:placeholder-shown)]:pt-[1.625rem]"
                                        id="CurrentPassword"
                                        placeholder="Current Password"/>
                                <label
                                        for="CurrentPassword"
                                        class="pointer-events-none absolute left-0 top-0 origin-[0_0] border border-solid border-transparent px-3 py-4 text-neutral-500 transition-[opacity,_transform] duration-200 ease-linear peer-focus:-translate-y-2 peer-focus:translate-x-[0.15rem] peer-focus:scale-[0.85] peer-focus:text-primary peer-[:not(:placeholder-shown)]:-translate-y-2 peer-[:not(:placeholder-shown)]:translate-x-[0.15rem] peer-[:not(:placeholder-shown)]:scale-[0.85] motion-reduce:transition-none"
                                >Enter Current Password</label>
                            </div>

                            <div class="relative mb-3">
                                <input
                                        type="text"
                                        class="peer m-0 block h-[58px] w-full rounded border border-solid border-neutral-300 bg-transparent bg-clip-padding px-6 py-4 text-lg font-normal leading-tight text-neutral-700 transition duration-200 ease-linear placeholder:text-transparent focus:border-primary focus:pb-[0.625rem] focus:pt-[1.625rem] focus:text-neutral-700 focus:outline-none peer-focus:text-primary [&:not(:placeholder-shown)]:pb-[0.625rem] [&:not(:placeholder-shown)]:pt-[1.625rem]"
                                        id="NewPassword"
                                        placeholder="New Password"/>
                                <label
                                        for="NewPassword"
                                        class="pointer-events-none absolute left-0 top-0 origin-[0_0] border border-solid border-transparent px-3 py-4 text-neutral-500 transition-[opacity,_transform] duration-200 ease-linear peer-focus:-translate-y-2 peer-focus:translate-x-[0.15rem] peer-focus:scale-[0.85] peer-focus:text-primary peer-[:not(:placeholder-shown)]:-translate-y-2 peer-[:not(:placeholder-shown)]:translate-x-[0.15rem] peer-[:not(:placeholder-shown)]:scale-[0.85] motion-reduce:transition-none"
                                >Enter New Password</label>
                            </div>
                            <p class="text-red-700" id="PasswordError" style="visibility: hidden">Please Enter your
                                current password and new password</p>
                            <div class="container flex-row">
                                <button id="SubmitPassword" class="bg-blue-500 mr-4 px-1 py-1 mx-2 my-2">
                                    Submit
                                </button>
                                <button class="bg-red-500 mr-4 px-1 py-1 mx-2 my-2">
                                    Cancel
                                </button>
                            </div>
                        </form>

                        <script>
                            $(document).ready(function () {
                                $("#SubmitPassword").click(function () {
                                    const user = <%-JSON.stringify(user) %>;
                                    const currentPassword = $('#CurrentPassword').val();
                                    const newPassword = $('#NewPassword').val();
                                    const passwordError = $('#PasswordError');

                                    data = {
                                        password: newPassword
                                    }

                                    if (user['password'] !== currentPassword) {
                                        passwordError.css("visibility", "visible")
                                        $('#CurrentPassword').text("")
                                        $('#NewPassword').text("");
                                        return
                                    }

                                    passwordError.css("visibility", "hidden")
                                    $.ajax({
                                        type: "PUT",
                                        url: '/api/v1/password/reset',
                                        data,
                                        success: function (serverResponse) {
                                            if (serverResponse) {
                                                location.href = '/dashboard';
                                                console.log("success")
                                            }
                                        },
                                        error: function (errorResponse) {
                                            if (errorResponse) {
                                                alert(`User Password reset error: ${errorResponse.responseText}`);
                                                console.log("error")
                                            }
                                        }
                                    });
                                });
                            });
                        </script>

                    </div>
                </dialog>


                <!-- todo if request is already sent on this account make the button unclickable, and set the status in the account description -->
                <button


                        type="button"
                        onclick="RequestSeniorAccountModal.showModal()"
                        class="w-full h-20 my-6 rounded rounded-lg bg-slate-300 text-l border border-gray-400 font-medium uppercase leading-normal text-black shadow-black/5 transition duration-150 ease-in-out hover:bg-slate-500 hover:shadow-2xl focus:bg-slate-700 focus:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.3),0_4px_18px_0_rgba(59,113,202,0.2)] focus:outline-none focus:ring-0 active:bg-primary-700 active:shadow-[0_8px_9px_-4px_rgba(59,113,202,0.3),0_4px_18px_0_rgba(59,113,202,0.2)](59,113,202,0.5)]-4px_rgba(59,113,202,0.2),0_4px_18px_0_rgba(59,113,202,0.1)]-4px_rgba(59,113,202,0.2),0_4px_18px_0_rgba(59,113,202,0.1)]-4px_rgba(59,113,202,0.2),0_4px_18px_0_rgba(59,113,202,0.1)]"
                        data-te-ripple-init
                >
                    Request Senior Account
                </button>


                <dialog class="" id="RequestSeniorAccountModal">
                    <div class="container flex flex-col">

                        <form class="flex flex-col container" method="dialog">

                            <button
                                    id="closeRequestSeniorAccountModal"
                                    type="reset"
                                    class="rounded-3xl bg-blue-500 text-bold text-2xl justify-self-end self-end mx-2 my-2 px-2 py-1">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                     class="bi bi-x" viewBox="0 0 16 16">
                                    <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
                                </svg>
                            </button>
                            <script>
                                $(document).ready(function () {
                                    const dialog = document.querySelector("#RequestSeniorAccountModal");
                                    const closeButton = document.querySelector("#closeRequestSeniorAccountModal");
                                    closeButton.addEventListener("click", () => {
                                        dialog.close();
                                    });
                                });
                            </script>

                            <div class="relative mb-3">
                                <input
                                        type="text"
                                        class="peer m-0 block h-[58px] w-full rounded border border-solid border-neutral-300 bg-transparent bg-clip-padding px-6 py-4 text-2xl font-normal leading-tight text-neutral-700 transition duration-200 ease-linear placeholder:text-transparent focus:border-primary focus:pb-[0.625rem] focus:pt-[1.625rem] focus:text-neutral-700 focus:outline-none peer-focus:text-primary [&:not(:placeholder-shown)]:pb-[0.625rem] [&:not(:placeholder-shown)]:pt-[1.625rem]"
                                        id="NationalId"
                                        placeholder="National ID"/>
                                <label
                                        for="NationalId"
                                        class="pointer-events-none absolute left-0 top-0 origin-[0_0] border border-solid border-transparent px-3 py-4 text-neutral-500 transition-[opacity,_transform] duration-200 ease-linear peer-focus:-translate-y-2 peer-focus:translate-x-[0.15rem] peer-focus:scale-[0.85] peer-focus:text-primary peer-[:not(:placeholder-shown)]:-translate-y-2 peer-[:not(:placeholder-shown)]:translate-x-[0.15rem] peer-[:not(:placeholder-shown)]:scale-[0.85] motion-reduce:transition-none"
                                >National ID</label>
                            </div>
                            <p class="text-red-700" id="NationalIdError" style="visibility: hidden">Please Enter your
                                National ID</p>
                            <div class="container flex-row">
                                <button onclick="RequestSeniorAccountModal.showModal()" id="SubmitSeniorRequest"
                                        class="bg-blue-500 mr-4 px-1 py-1 mx-2 my-2">
                                    Submit Request
                                </button>
                                <button class="bg-red-500 mr-4 px-1 py-1 mx-2 my-2">
                                    Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                </dialog>

                <script>
                    $(document).ready(function () {
                        $("#SubmitSeniorRequest").click(function () {
                            const user = <%-JSON.stringify(user) %>;
                            const nationalID = $('#NationalId').val();
                            const inputError = $('#NationalIdError');
                            let inputErrorVal = $('#NationalIdError').val();

                            data = {
                                nationalid: nationalID,
                            }
                            console.log(data)

                            if (nationalID === '') {
                                inputError.css("visibility", "visible")
                                inputErrorVal = "Please Enter your National ID"
                                $('#NationalId').text("");
                                return
                            }
                            inputError.css("visibility", "hidden")

                            $.ajax({
                                type: "POST",
                                url: '/api/v1/senior/request',
                                data,
                                success: function (serverResponse) {
                                    if (serverResponse) {
                                        console.log("success")
                                    }
                                },
                                error: function (errorResponse) {
                                    if (errorResponse) {
                                        $('#NationalIdError').text(errorResponse.responseText);
                                        inputError.css("visibility", "visible")

                                        console.log("error")
                                    }
                                }
                            });
                        });
                    });
                </script>

            </div>
        </div>
    </section>

</div>

<footer class="bg-white dark:bg-gray-900">
    <div class="mx-auto w-full max-w-screen-xl p-4 py-6 lg:py-8">
        <div class="sm:flex sm:items-center sm:justify-between">
          <span class="text-sm text-gray-500 sm:text-center dark:text-gray-400">© 2023 <a
                  href="https://cairometro.gov.eg/en"
                  class="hover:underline">Gomhoryt masr el 3arabya™</a>. All Rights Reserved.
          </span>
            <div class="flex mt-4 space-x-6 sm:justify-center sm:mt-0">
                <a href="#" class="text-gray-500 hover:text-gray-900 dark:hover:text-white">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                        <path fill-rule="evenodd"
                              d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z"
                              clip-rule="evenodd"/>
                    </svg>
                    <span class="sr-only">Facebook page</span>
                </a>
                <a href="#" class="text-gray-500 hover:text-gray-900 dark:hover:text-white">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                        <path fill-rule="evenodd"
                              d="M12.315 2c2.43 0 2.784.013 3.808.06 1.064.049 1.791.218 2.427.465a4.902 4.902 0 011.772 1.153 4.902 4.902 0 011.153 1.772c.247.636.416 1.363.465 2.427.048 1.067.06 1.407.06 4.123v.08c0 2.643-.012 2.987-.06 4.043-.049 1.064-.218 1.791-.465 2.427a4.902 4.902 0 01-1.153 1.772 4.902 4.902 0 01-1.772 1.153c-.636.247-1.363.416-2.427.465-1.067.048-1.407.06-4.123.06h-.08c-2.643 0-2.987-.012-4.043-.06-1.064-.049-1.791-.218-2.427-.465a4.902 4.902 0 01-1.772-1.153 4.902 4.902 0 01-1.153-1.772c-.247-.636-.416-1.363-.465-2.427-.047-1.024-.06-1.379-.06-3.808v-.63c0-2.43.013-2.784.06-3.808.049-1.064.218-1.791.465-2.427a4.902 4.902 0 011.153-1.772A4.902 4.902 0 015.45 2.525c.636-.247 1.363-.416 2.427-.465C8.901 2.013 9.256 2 11.685 2h.63zm-.081 1.802h-.468c-2.456 0-2.784.011-3.807.058-.975.045-1.504.207-1.857.344-.467.182-.8.398-1.15.748-.35.35-.566.683-.748 1.15-.137.353-.3.882-.344 1.857-.047 1.023-.058 1.351-.058 3.807v.468c0 2.456.011 2.784.058 3.807.045.975.207 1.504.344 1.857.182.466.399.8.748 1.15.35.35.683.566 1.15.748.353.137.882.3 1.857.344 1.054.048 1.37.058 4.041.058h.08c2.597 0 2.917-.01 3.96-.058.976-.045 1.505-.207 1.858-.344.466-.182.8-.398 1.15-.748.35-.35.566-.683.748-1.15.137-.353.3-.882.344-1.857.048-1.055.058-1.37.058-4.041v-.08c0-2.597-.01-2.917-.058-3.96-.045-.976-.207-1.505-.344-1.858a3.097 3.097 0 00-.748-1.15 3.098 3.098 0 00-1.15-.748c-.353-.137-.882-.3-1.857-.344-1.023-.047-1.351-.058-3.807-.058zM12 6.865a5.135 5.135 0 110 10.27 5.135 5.135 0 010-10.27zm0 1.802a3.333 3.333 0 100 6.666 3.333 3.333 0 000-6.666zm5.338-3.205a1.2 1.2 0 110 2.4 1.2 1.2 0 010-2.4z"
                              clip-rule="evenodd"/>
                    </svg>
                    <span class="sr-only">Instagram page</span>
                </a>
                <a href="#" class="text-gray-500 hover:text-gray-900 dark:hover:text-white">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                        <path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"/>
                    </svg>
                    <span class="sr-only">Twitter page</span>
                </a>
                <a href="#" class="text-gray-500 hover:text-gray-900 dark:hover:text-white">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                        <path fill-rule="evenodd"
                              d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z"
                              clip-rule="evenodd"/>
                    </svg>
                    <span class="sr-only">GitHub account</span>
                </a>
            </div>
        </div>
    </div>
</footer>

</body>
</html>
